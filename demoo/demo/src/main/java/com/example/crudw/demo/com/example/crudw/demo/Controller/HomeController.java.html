<html>
<head>
<title>HomeController.java</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #cf8e6d;}
.s1 { color: #bcbec4;}
.s2 { color: #bcbec4;}
.s3 { color: #6aab73;}
.s4 { color: #7a7e85;}
.s5 { color: #2aacb8;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
HomeController.java</font>
</center></td></tr></table>
<pre><span class="s0">package </span><span class="s1">com</span><span class="s2">.</span><span class="s1">example</span><span class="s2">.</span><span class="s1">crudw</span><span class="s2">.</span><span class="s1">demo</span><span class="s2">.</span><span class="s1">Controller</span><span class="s2">;</span>
<span class="s0">import </span><span class="s1">com</span><span class="s2">.</span><span class="s1">example</span><span class="s2">.</span><span class="s1">crudw</span><span class="s2">.</span><span class="s1">demo</span><span class="s2">.</span><span class="s1">Board</span><span class="s2">.</span><span class="s1">Board</span><span class="s2">;</span>
<span class="s0">import </span><span class="s1">com</span><span class="s2">.</span><span class="s1">example</span><span class="s2">.</span><span class="s1">crudw</span><span class="s2">.</span><span class="s1">demo</span><span class="s2">.</span><span class="s1">Heart</span><span class="s2">.</span><span class="s1">Heart</span><span class="s2">;</span>
<span class="s0">import </span><span class="s1">com</span><span class="s2">.</span><span class="s1">example</span><span class="s2">.</span><span class="s1">crudw</span><span class="s2">.</span><span class="s1">demo</span><span class="s2">.</span><span class="s1">Heart</span><span class="s2">.</span><span class="s1">HeartService</span><span class="s2">;</span>
<span class="s0">import </span><span class="s1">com</span><span class="s2">.</span><span class="s1">example</span><span class="s2">.</span><span class="s1">crudw</span><span class="s2">.</span><span class="s1">demo</span><span class="s2">.</span><span class="s1">Member</span><span class="s2">.</span><span class="s1">User</span><span class="s2">;</span>
<span class="s0">import </span><span class="s1">com</span><span class="s2">.</span><span class="s1">example</span><span class="s2">.</span><span class="s1">crudw</span><span class="s2">.</span><span class="s1">demo</span><span class="s2">.</span><span class="s1">Member</span><span class="s2">.</span><span class="s1">UserForm</span><span class="s2">;</span>
<span class="s0">import </span><span class="s1">com</span><span class="s2">.</span><span class="s1">example</span><span class="s2">.</span><span class="s1">crudw</span><span class="s2">.</span><span class="s1">demo</span><span class="s2">.</span><span class="s1">Member</span><span class="s2">.</span><span class="s1">UserUpdate</span><span class="s2">;</span>
<span class="s0">import </span><span class="s1">com</span><span class="s2">.</span><span class="s1">example</span><span class="s2">.</span><span class="s1">crudw</span><span class="s2">.</span><span class="s1">demo</span><span class="s2">.</span><span class="s1">Service</span><span class="s2">.</span><span class="s1">BoardService</span><span class="s2">;</span>
<span class="s0">import </span><span class="s1">com</span><span class="s2">.</span><span class="s1">example</span><span class="s2">.</span><span class="s1">crudw</span><span class="s2">.</span><span class="s1">demo</span><span class="s2">.</span><span class="s1">Service</span><span class="s2">.</span><span class="s1">CommentService</span><span class="s2">;</span>
<span class="s0">import </span><span class="s1">com</span><span class="s2">.</span><span class="s1">example</span><span class="s2">.</span><span class="s1">crudw</span><span class="s2">.</span><span class="s1">demo</span><span class="s2">.</span><span class="s1">Service</span><span class="s2">.</span><span class="s1">UserService</span><span class="s2">;</span>
<span class="s0">import </span><span class="s1">com</span><span class="s2">.</span><span class="s1">example</span><span class="s2">.</span><span class="s1">crudw</span><span class="s2">.</span><span class="s1">demo</span><span class="s2">.</span><span class="s1">comment</span><span class="s2">.</span><span class="s1">Comment</span><span class="s2">;</span>
<span class="s0">import </span><span class="s1">com</span><span class="s2">.</span><span class="s1">example</span><span class="s2">.</span><span class="s1">crudw</span><span class="s2">.</span><span class="s1">demo</span><span class="s2">.</span><span class="s1">comment</span><span class="s2">.</span><span class="s1">CommentRequestDto</span><span class="s2">;</span>
<span class="s0">import </span><span class="s1">com</span><span class="s2">.</span><span class="s1">example</span><span class="s2">.</span><span class="s1">crudw</span><span class="s2">.</span><span class="s1">demo</span><span class="s2">.</span><span class="s1">comment</span><span class="s2">.</span><span class="s1">CommentWithBoardTitle</span><span class="s2">;</span>
<span class="s0">import </span><span class="s1">jakarta</span><span class="s2">.</span><span class="s1">persistence</span><span class="s2">.</span><span class="s1">EntityManager</span><span class="s2">;</span>
<span class="s0">import </span><span class="s1">jakarta</span><span class="s2">.</span><span class="s1">servlet</span><span class="s2">.</span><span class="s1">http</span><span class="s2">.</span><span class="s1">HttpServletRequest</span><span class="s2">;</span>
<span class="s0">import </span><span class="s1">jakarta</span><span class="s2">.</span><span class="s1">servlet</span><span class="s2">.</span><span class="s1">http</span><span class="s2">.</span><span class="s1">HttpSession</span><span class="s2">;</span>
<span class="s0">import </span><span class="s1">lombok</span><span class="s2">.</span><span class="s1">extern</span><span class="s2">.</span><span class="s1">slf4j</span><span class="s2">.</span><span class="s1">Slf4j</span><span class="s2">;</span>
<span class="s0">import </span><span class="s1">org</span><span class="s2">.</span><span class="s1">springframework</span><span class="s2">.</span><span class="s1">beans</span><span class="s2">.</span><span class="s1">factory</span><span class="s2">.</span><span class="s1">annotation</span><span class="s2">.</span><span class="s1">Autowired</span><span class="s2">;</span>
<span class="s0">import </span><span class="s1">org</span><span class="s2">.</span><span class="s1">springframework</span><span class="s2">.</span><span class="s1">data</span><span class="s2">.</span><span class="s1">domain</span><span class="s2">.</span><span class="s1">Page</span><span class="s2">;</span>
<span class="s0">import </span><span class="s1">org</span><span class="s2">.</span><span class="s1">springframework</span><span class="s2">.</span><span class="s1">data</span><span class="s2">.</span><span class="s1">domain</span><span class="s2">.</span><span class="s1">PageImpl</span><span class="s2">;</span>
<span class="s0">import </span><span class="s1">org</span><span class="s2">.</span><span class="s1">springframework</span><span class="s2">.</span><span class="s1">data</span><span class="s2">.</span><span class="s1">domain</span><span class="s2">.</span><span class="s1">Pageable</span><span class="s2">;</span>
<span class="s0">import </span><span class="s1">org</span><span class="s2">.</span><span class="s1">springframework</span><span class="s2">.</span><span class="s1">data</span><span class="s2">.</span><span class="s1">domain</span><span class="s2">.</span><span class="s1">Sort</span><span class="s2">;</span>
<span class="s0">import </span><span class="s1">org</span><span class="s2">.</span><span class="s1">springframework</span><span class="s2">.</span><span class="s1">data</span><span class="s2">.</span><span class="s1">web</span><span class="s2">.</span><span class="s1">PageableDefault</span><span class="s2">;</span>
<span class="s0">import </span><span class="s1">org</span><span class="s2">.</span><span class="s1">springframework</span><span class="s2">.</span><span class="s1">security</span><span class="s2">.</span><span class="s1">core</span><span class="s2">.</span><span class="s1">Authentication</span><span class="s2">;</span>
<span class="s0">import </span><span class="s1">org</span><span class="s2">.</span><span class="s1">springframework</span><span class="s2">.</span><span class="s1">security</span><span class="s2">.</span><span class="s1">core</span><span class="s2">.</span><span class="s1">annotation</span><span class="s2">.</span><span class="s1">AuthenticationPrincipal</span><span class="s2">;</span>
<span class="s0">import </span><span class="s1">org</span><span class="s2">.</span><span class="s1">springframework</span><span class="s2">.</span><span class="s1">security</span><span class="s2">.</span><span class="s1">core</span><span class="s2">.</span><span class="s1">context</span><span class="s2">.</span><span class="s1">SecurityContextHolder</span><span class="s2">;</span>
<span class="s0">import </span><span class="s1">org</span><span class="s2">.</span><span class="s1">springframework</span><span class="s2">.</span><span class="s1">security</span><span class="s2">.</span><span class="s1">oauth2</span><span class="s2">.</span><span class="s1">core</span><span class="s2">.</span><span class="s1">user</span><span class="s2">.</span><span class="s1">OAuth2User</span><span class="s2">;</span>
<span class="s0">import </span><span class="s1">org</span><span class="s2">.</span><span class="s1">springframework</span><span class="s2">.</span><span class="s1">stereotype</span><span class="s2">.</span><span class="s1">Controller</span><span class="s2">;</span>
<span class="s0">import </span><span class="s1">org</span><span class="s2">.</span><span class="s1">springframework</span><span class="s2">.</span><span class="s1">ui</span><span class="s2">.</span><span class="s1">Model</span><span class="s2">;</span>

<span class="s0">import </span><span class="s1">org</span><span class="s2">.</span><span class="s1">springframework</span><span class="s2">.</span><span class="s1">web</span><span class="s2">.</span><span class="s1">bind</span><span class="s2">.</span><span class="s1">annotation</span><span class="s2">.*;</span>

<span class="s0">import </span><span class="s1">java</span><span class="s2">.</span><span class="s1">util</span><span class="s2">.</span><span class="s1">ArrayList</span><span class="s2">;</span>
<span class="s0">import </span><span class="s1">java</span><span class="s2">.</span><span class="s1">util</span><span class="s2">.</span><span class="s1">HashMap</span><span class="s2">;</span>
<span class="s0">import </span><span class="s1">java</span><span class="s2">.</span><span class="s1">util</span><span class="s2">.</span><span class="s1">List</span><span class="s2">;</span>
<span class="s0">import </span><span class="s1">java</span><span class="s2">.</span><span class="s1">util</span><span class="s2">.</span><span class="s1">Map</span><span class="s2">;</span>


<span class="s1">@Slf4j</span>
<span class="s1">@Controller</span>
<span class="s0">public class </span><span class="s1">HomeController </span><span class="s2">{</span>
    <span class="s1">@Autowired</span>
    <span class="s1">UserService userService</span><span class="s2">;</span>
    <span class="s1">@Autowired</span>
    <span class="s1">BoardService boardService</span><span class="s2">;</span>
    <span class="s1">@Autowired</span>
    <span class="s1">CommentService commentService</span><span class="s2">;</span>
    <span class="s1">@Autowired</span>
    <span class="s1">HeartService heartService</span><span class="s2">;</span>
    <span class="s1">@Autowired</span>
    <span class="s1">EntityManager em</span><span class="s2">;</span>


    <span class="s1">@GetMapping</span><span class="s2">(</span><span class="s1">value </span><span class="s2">= </span><span class="s3">&quot;/&quot;</span><span class="s2">)</span>
    <span class="s0">public </span><span class="s1">String home</span><span class="s2">() {</span>
        <span class="s0">return </span><span class="s3">&quot;index&quot;</span><span class="s2">;</span>
    <span class="s2">}</span>
    <span class="s1">@GetMapping</span><span class="s2">(</span><span class="s1">value</span><span class="s2">=</span><span class="s3">&quot;/loginhome&quot;</span><span class="s2">)</span>
    <span class="s0">public </span><span class="s1">String loginhome</span><span class="s2">(){</span><span class="s0">return </span><span class="s3">&quot;loginhome&quot;</span><span class="s2">;}</span>
    <span class="s1">@GetMapping</span><span class="s2">(</span><span class="s1">value </span><span class="s2">= </span><span class="s3">&quot;/signup&quot;</span><span class="s2">)</span>
    <span class="s0">public </span><span class="s1">String signup</span><span class="s2">(</span><span class="s1">Model model</span><span class="s2">) {</span>
        <span class="s0">return </span><span class="s3">&quot;signup&quot;</span><span class="s2">; </span><span class="s4">// 오타 수정</span>
    <span class="s2">}</span>
    <span class="s1">@PostMapping</span><span class="s2">(</span><span class="s1">path</span><span class="s2">=</span><span class="s3">&quot;/addUser&quot;</span><span class="s2">)</span>
    <span class="s0">public </span><span class="s1">String addUser</span><span class="s2">(</span><span class="s1">@ModelAttribute User user</span><span class="s2">, </span><span class="s1">Model model</span><span class="s2">) {</span>
        <span class="s0">boolean </span><span class="s1">exist </span><span class="s2">= </span><span class="s1">userService</span><span class="s2">.</span><span class="s1">getUser</span><span class="s2">(</span><span class="s1">user</span><span class="s2">.</span><span class="s1">getId</span><span class="s2">()) != </span><span class="s0">null</span><span class="s2">;</span>

        <span class="s0">if </span><span class="s2">(</span><span class="s1">exist </span><span class="s2">== </span><span class="s0">true</span><span class="s2">) {</span>
            <span class="s1">model</span><span class="s2">.</span><span class="s1">addAttribute</span><span class="s2">(</span><span class="s3">&quot;msg&quot;</span><span class="s2">, </span><span class="s3">&quot;회원가입에 실패하였습니다.&quot;</span><span class="s2">);</span>
            <span class="s1">model</span><span class="s2">.</span><span class="s1">addAttribute</span><span class="s2">(</span><span class="s3">&quot;url&quot;</span><span class="s2">, </span><span class="s3">&quot;signup&quot;</span><span class="s2">);</span>
        <span class="s2">} </span><span class="s0">else </span><span class="s2">{</span>
            <span class="s1">Long no </span><span class="s2">= </span><span class="s1">userService</span><span class="s2">.</span><span class="s1">saveUser</span><span class="s2">(</span><span class="s1">user</span><span class="s2">);</span>
            <span class="s1">model</span><span class="s2">.</span><span class="s1">addAttribute</span><span class="s2">(</span><span class="s3">&quot;msg&quot;</span><span class="s2">, </span><span class="s3">&quot;회원가입에 성공하였습니다.&quot;</span><span class="s2">);</span>
            <span class="s1">model</span><span class="s2">.</span><span class="s1">addAttribute</span><span class="s2">(</span><span class="s3">&quot;url&quot;</span><span class="s2">, </span><span class="s3">&quot;login&quot;</span><span class="s2">);</span>
        <span class="s2">}</span>

        <span class="s0">return </span><span class="s3">&quot;alert&quot;</span><span class="s2">;</span>
    <span class="s2">}</span>
    <span class="s1">@GetMapping</span><span class="s2">(</span><span class="s1">value </span><span class="s2">= </span><span class="s3">&quot;/login&quot;</span><span class="s2">)</span>
    <span class="s0">public </span><span class="s1">String login</span><span class="s2">() {</span>
        <span class="s0">return </span><span class="s3">&quot;login&quot;</span><span class="s2">;</span>
    <span class="s2">}</span>
    <span class="s1">@PostMapping</span><span class="s2">(</span><span class="s1">path </span><span class="s2">= </span><span class="s3">&quot;/checkLogin&quot;</span><span class="s2">)</span>
    <span class="s0">public </span><span class="s1">String checkLogin</span><span class="s2">(</span><span class="s1">@RequestParam</span><span class="s2">(</span><span class="s1">value</span><span class="s2">=</span><span class="s3">&quot;id&quot;</span><span class="s2">)</span><span class="s1">String id</span><span class="s2">,</span>
                             <span class="s1">@RequestParam</span><span class="s2">(</span><span class="s1">value</span><span class="s2">=</span><span class="s3">&quot;pw&quot;</span><span class="s2">) </span><span class="s1">String pw</span><span class="s2">,</span>
                             <span class="s1">Model model</span><span class="s2">,</span><span class="s1">HttpServletRequest request</span><span class="s2">,</span><span class="s1">@ModelAttribute UserForm form</span><span class="s2">){</span>
        <span class="s0">boolean </span><span class="s1">result </span><span class="s2">= </span><span class="s1">userService</span><span class="s2">.</span><span class="s1">login</span><span class="s2">(</span><span class="s1">id</span><span class="s2">, </span><span class="s1">pw</span><span class="s2">);</span>
        <span class="s1">String page</span><span class="s2">;</span>

        <span class="s0">if</span><span class="s2">(</span><span class="s1">result </span><span class="s2">== </span><span class="s0">false</span><span class="s2">){</span>
            <span class="s1">model</span><span class="s2">.</span><span class="s1">addAttribute</span><span class="s2">(</span><span class="s3">&quot;msg&quot;</span><span class="s2">,</span><span class="s3">&quot;로그인 정보가 맞지않습니다.&quot;</span><span class="s2">);</span>
            <span class="s1">model</span><span class="s2">.</span><span class="s1">addAttribute</span><span class="s2">(</span><span class="s3">&quot;url&quot;</span><span class="s2">,</span><span class="s3">&quot;login&quot;</span><span class="s2">);</span>
            <span class="s1">page</span><span class="s2">=</span><span class="s3">&quot;alert&quot;</span><span class="s2">;</span>
        <span class="s2">}</span><span class="s0">else</span><span class="s2">{</span>
            <span class="s1">User user </span><span class="s2">= </span><span class="s1">userService</span><span class="s2">.</span><span class="s1">getUser</span><span class="s2">(</span><span class="s1">id</span><span class="s2">);</span>

            <span class="s1">HttpSession session </span><span class="s2">= </span><span class="s1">request</span><span class="s2">.</span><span class="s1">getSession</span><span class="s2">();</span>
            <span class="s1">session</span><span class="s2">.</span><span class="s1">setAttribute</span><span class="s2">(</span><span class="s3">&quot;id&quot;</span><span class="s2">,</span><span class="s1">id</span><span class="s2">);</span>
            <span class="s1">session</span><span class="s2">.</span><span class="s1">setAttribute</span><span class="s2">(</span><span class="s3">&quot;pw&quot;</span><span class="s2">,</span><span class="s1">pw</span><span class="s2">);</span>
            <span class="s1">session</span><span class="s2">.</span><span class="s1">setAttribute</span><span class="s2">(</span><span class="s3">&quot;no&quot;</span><span class="s2">, </span><span class="s1">user</span><span class="s2">.</span><span class="s1">getNo</span><span class="s2">()); </span><span class="s4">//글 작성할때 넣어야해서...user정보랑 같이 넣는 느낌..?</span>

            <span class="s1">String sessionId </span><span class="s2">= </span><span class="s1">session</span><span class="s2">.</span><span class="s1">getId</span><span class="s2">(); </span><span class="s4">// 세션 ID를 얻어옵니다</span>

            <span class="s1">Authentication authentication </span><span class="s2">= </span><span class="s1">SecurityContextHolder</span><span class="s2">.</span><span class="s1">getContext</span><span class="s2">().</span><span class="s1">getAuthentication</span><span class="s2">();</span>
            <span class="s4">//SecurityUser users = (SecurityUser) authentication.getPrincipal();</span>
            <span class="s1">String username </span><span class="s2">= </span><span class="s1">authentication</span><span class="s2">.</span><span class="s1">getName</span><span class="s2">();</span>
            <span class="s1">model</span><span class="s2">.</span><span class="s1">addAttribute</span><span class="s2">(</span><span class="s3">&quot;sessionId&quot;</span><span class="s2">, </span><span class="s1">sessionId</span><span class="s2">);</span>
            <span class="s1">model</span><span class="s2">.</span><span class="s1">addAttribute</span><span class="s2">(</span><span class="s3">&quot;username&quot;</span><span class="s2">, </span><span class="s1">username</span><span class="s2">); </span><span class="s4">// 사용자 ID를 모델에 추가</span>
            <span class="s1">page</span><span class="s2">=</span><span class="s3">&quot;redirect:/&quot;</span><span class="s2">;</span>
        <span class="s2">}</span>
        <span class="s0">return </span><span class="s1">page</span><span class="s2">;</span>
    <span class="s2">}</span>
    <span class="s1">@ResponseBody</span>
    <span class="s1">@GetMapping</span><span class="s2">(</span><span class="s3">&quot;/login/oauth2/code/kakao&quot;</span><span class="s2">)</span>
    <span class="s0">public void  </span><span class="s1">kakaoCallback</span><span class="s2">(</span><span class="s1">@RequestParam String code</span><span class="s2">) {</span>

        <span class="s1">System</span><span class="s2">.</span><span class="s1">out</span><span class="s2">.</span><span class="s1">println</span><span class="s2">(</span><span class="s1">code</span><span class="s2">);</span>

    <span class="s2">}</span>
    <span class="s1">@GetMapping</span><span class="s2">(</span><span class="s3">&quot;/socialLogin&quot;</span><span class="s2">)</span>
    <span class="s0">public </span><span class="s1">String socialLoginPage</span><span class="s2">(</span><span class="s1">@RequestParam String provider</span><span class="s2">) {</span>
      <span class="s0">if </span><span class="s2">(</span><span class="s3">&quot;naver&quot;</span><span class="s2">.</span><span class="s1">equals</span><span class="s2">(</span><span class="s1">provider</span><span class="s2">)) {</span>
            <span class="s0">return </span><span class="s3">&quot;redirect:/login/oauth2/code/naver&quot;</span><span class="s2">;</span>
        <span class="s2">} </span><span class="s0">else if </span><span class="s2">(</span><span class="s3">&quot;kakao&quot;</span><span class="s2">.</span><span class="s1">equals</span><span class="s2">(</span><span class="s1">provider</span><span class="s2">)){</span>
            <span class="s0">return </span><span class="s3">&quot;redirect:/login/oauth2/code/kakao&quot;</span><span class="s2">;</span>
        <span class="s2">}</span><span class="s0">else</span><span class="s2">{</span>
          <span class="s0">return </span><span class="s3">&quot;redirect:/login/oauth2/code/google&quot;</span><span class="s2">;</span>
      <span class="s2">}</span>

    <span class="s2">}</span>
    <span class="s1">@GetMapping</span><span class="s2">(</span><span class="s3">&quot;/login/oauth2/code/{registrationId}&quot;</span><span class="s2">)</span>
    <span class="s0">public </span><span class="s1">String googleLogin</span><span class="s2">(</span><span class="s1">@RequestParam String code</span><span class="s2">, </span><span class="s1">@PathVariable String registrationId</span><span class="s2">) {</span>
        <span class="s1">userService</span><span class="s2">.</span><span class="s1">socialLogin</span><span class="s2">(</span><span class="s1">code</span><span class="s2">, </span><span class="s1">registrationId</span><span class="s2">);</span>
        <span class="s0">return </span><span class="s3">&quot;redirect:/&quot;</span><span class="s2">;</span>
    <span class="s2">}</span>
    <span class="s1">@GetMapping</span><span class="s2">(</span><span class="s3">&quot;/oauth/loginInfo&quot;</span><span class="s2">)</span>
    <span class="s0">public </span><span class="s1">String oauthLoginInfo</span><span class="s2">(</span><span class="s1">Authentication authentication</span><span class="s2">,</span><span class="s1">Model model</span><span class="s2">,</span><span class="s1">HttpSession session</span><span class="s2">) {</span>
        <span class="s1">OAuth2User oAuth2User </span><span class="s2">= (</span><span class="s1">OAuth2User</span><span class="s2">) </span><span class="s1">authentication</span><span class="s2">.</span><span class="s1">getPrincipal</span><span class="s2">();</span>
        <span class="s1">Map</span><span class="s2">&lt;</span><span class="s1">String</span><span class="s2">, </span><span class="s1">Object</span><span class="s2">&gt; </span><span class="s1">attributes </span><span class="s2">= </span><span class="s1">oAuth2User</span><span class="s2">.</span><span class="s1">getAttributes</span><span class="s2">();</span>
        <span class="s1">System</span><span class="s2">.</span><span class="s1">out</span><span class="s2">.</span><span class="s1">println</span><span class="s2">(</span><span class="s1">attributes</span><span class="s2">.</span><span class="s1">toString</span><span class="s2">());</span>
        <span class="s1">model</span><span class="s2">.</span><span class="s1">addAttribute</span><span class="s2">(</span><span class="s3">&quot;name&quot;</span><span class="s2">,</span><span class="s1">attributes</span><span class="s2">.</span><span class="s1">get</span><span class="s2">(</span><span class="s3">&quot;name&quot;</span><span class="s2">));</span>
        <span class="s1">session</span><span class="s2">.</span><span class="s1">setAttribute</span><span class="s2">(</span><span class="s3">&quot;name&quot;</span><span class="s2">, </span><span class="s1">attributes</span><span class="s2">.</span><span class="s1">get</span><span class="s2">(</span><span class="s3">&quot;name&quot;</span><span class="s2">));</span>
        <span class="s0">return </span><span class="s3">&quot;redirect:/&quot;</span><span class="s2">;</span>
    <span class="s2">}</span>
    <span class="s1">@GetMapping</span><span class="s2">(</span><span class="s1">value </span><span class="s2">= </span><span class="s3">&quot;/findIdPw&quot;</span><span class="s2">)</span>
    <span class="s0">public </span><span class="s1">String findid</span><span class="s2">() {</span>
        <span class="s0">return </span><span class="s3">&quot;findIdPw&quot;</span><span class="s2">;</span>
    <span class="s2">}</span>
    <span class="s1">@PostMapping</span><span class="s2">(</span><span class="s1">path</span><span class="s2">=</span><span class="s3">&quot;/findId&quot;</span><span class="s2">, </span><span class="s1">produces </span><span class="s2">= </span><span class="s3">&quot;application/json&quot;</span><span class="s2">)</span>
    <span class="s1">@ResponseBody</span>
    <span class="s0">public </span><span class="s1">Map</span><span class="s2">&lt;</span><span class="s1">String</span><span class="s2">, </span><span class="s1">String</span><span class="s2">&gt; </span><span class="s1">findId</span><span class="s2">(</span><span class="s1">@RequestParam</span><span class="s2">(</span><span class="s1">value </span><span class="s2">= </span><span class="s3">&quot;name&quot;</span><span class="s2">) </span><span class="s1">String name</span><span class="s2">,</span>
                                      <span class="s1">@RequestParam</span><span class="s2">(</span><span class="s1">value </span><span class="s2">= </span><span class="s3">&quot;email&quot;</span><span class="s2">) </span><span class="s1">String email</span><span class="s2">) {</span>
        <span class="s1">Map</span><span class="s2">&lt;</span><span class="s1">String</span><span class="s2">, </span><span class="s1">String</span><span class="s2">&gt; </span><span class="s1">response </span><span class="s2">= </span><span class="s0">new </span><span class="s1">HashMap</span><span class="s2">&lt;&gt;();</span>
        <span class="s1">User foundUsers </span><span class="s2">= </span><span class="s1">userService</span><span class="s2">.</span><span class="s1">findId</span><span class="s2">(</span><span class="s1">name</span><span class="s2">, </span><span class="s1">email</span><span class="s2">);</span>
        <span class="s0">if </span><span class="s2">(</span><span class="s1">foundUsers </span><span class="s2">!= </span><span class="s0">null</span><span class="s2">) {</span>
            <span class="s1">response</span><span class="s2">.</span><span class="s1">put</span><span class="s2">(</span><span class="s3">&quot;foundUser&quot;</span><span class="s2">, </span><span class="s1">foundUsers</span><span class="s2">.</span><span class="s1">getId</span><span class="s2">());</span>
        <span class="s2">} </span><span class="s0">else </span><span class="s2">{</span>
            <span class="s1">response</span><span class="s2">.</span><span class="s1">put</span><span class="s2">(</span><span class="s3">&quot;notfound&quot;</span><span class="s2">, </span><span class="s3">&quot;true&quot;</span><span class="s2">);</span>
        <span class="s2">}</span>
        <span class="s0">return </span><span class="s1">response</span><span class="s2">;</span>
    <span class="s2">}</span>
    <span class="s1">@GetMapping</span><span class="s2">(</span><span class="s1">path</span><span class="s2">=</span><span class="s3">&quot;/logout&quot;</span><span class="s2">)</span>
    <span class="s0">public </span><span class="s1">String login</span><span class="s2">(</span><span class="s1">HttpServletRequest request</span><span class="s2">){</span>
        <span class="s1">HttpSession session </span><span class="s2">= </span><span class="s1">request</span><span class="s2">.</span><span class="s1">getSession</span><span class="s2">();</span>
        <span class="s1">session</span><span class="s2">.</span><span class="s1">invalidate</span><span class="s2">(); </span><span class="s4">//로그아웃시 세션 만료</span>
        <span class="s0">return </span><span class="s3">&quot;redirect:/&quot;</span><span class="s2">;</span>
    <span class="s2">}</span>



    <span class="s1">@GetMapping</span><span class="s2">(</span><span class="s1">value </span><span class="s2">= </span><span class="s3">&quot;/write&quot;</span><span class="s2">)</span>
    <span class="s0">public </span><span class="s1">String write</span><span class="s2">() {</span>
        <span class="s0">return </span><span class="s3">&quot;write&quot;</span><span class="s2">;</span>
    <span class="s2">}</span>

    <span class="s1">@GetMapping</span><span class="s2">(</span><span class="s1">value </span><span class="s2">= {</span><span class="s3">&quot;/list&quot;</span><span class="s2">, </span><span class="s3">&quot;/search&quot;</span><span class="s2">})</span>
    <span class="s0">public </span><span class="s1">String listAndSearch</span><span class="s2">(</span><span class="s1">@RequestParam</span><span class="s2">(</span><span class="s1">value </span><span class="s2">= </span><span class="s3">&quot;searchStr&quot;</span><span class="s2">, </span><span class="s1">required </span><span class="s2">= </span><span class="s0">false</span><span class="s2">) </span><span class="s1">String searchStr</span><span class="s2">,</span>
                                <span class="s1">@RequestParam</span><span class="s2">(</span><span class="s1">value </span><span class="s2">= </span><span class="s3">&quot;searchType&quot;</span><span class="s2">,</span><span class="s1">required </span><span class="s2">= </span><span class="s0">false</span><span class="s2">) </span><span class="s1">String searchType</span><span class="s2">,</span>
                                <span class="s1">Model model</span><span class="s2">,</span>
                                <span class="s1">@PageableDefault</span><span class="s2">(</span><span class="s1">size </span><span class="s2">= </span><span class="s5">10</span><span class="s2">, </span><span class="s1">sort </span><span class="s2">= </span><span class="s3">&quot;no&quot;</span><span class="s2">, </span><span class="s1">direction </span><span class="s2">= </span><span class="s1">Sort</span><span class="s2">.</span><span class="s1">Direction</span><span class="s2">.</span><span class="s1">DESC</span><span class="s2">) </span><span class="s1">Pageable pageable</span><span class="s2">) {</span>

        <span class="s1">Page</span><span class="s2">&lt;</span><span class="s1">Board</span><span class="s2">&gt; </span><span class="s1">boardPage</span><span class="s2">;</span>
        <span class="s1">System</span><span class="s2">.</span><span class="s1">out</span><span class="s2">.</span><span class="s1">println</span><span class="s2">(</span><span class="s1">searchStr </span><span class="s2">+ </span><span class="s1">searchType</span><span class="s2">);</span>

        <span class="s0">if </span><span class="s2">(</span><span class="s1">searchStr </span><span class="s2">!= </span><span class="s0">null </span><span class="s2">&amp;&amp; !</span><span class="s1">searchStr</span><span class="s2">.</span><span class="s1">isEmpty</span><span class="s2">()) { </span><span class="s4">//searchStr가 비어있지않다면 검색기능 수행</span>
            <span class="s1">List</span><span class="s2">&lt;</span><span class="s1">Board</span><span class="s2">&gt; </span><span class="s1">searchList </span><span class="s2">= </span><span class="s1">boardService</span><span class="s2">.</span><span class="s1">search</span><span class="s2">(</span><span class="s1">searchStr</span><span class="s2">,</span><span class="s1">searchType</span><span class="s2">);</span>
            <span class="s1">boardPage </span><span class="s2">= </span><span class="s0">new </span><span class="s1">PageImpl</span><span class="s2">&lt;&gt;(</span><span class="s1">searchList</span><span class="s2">, </span><span class="s1">pageable</span><span class="s2">, </span><span class="s1">searchList</span><span class="s2">.</span><span class="s1">size</span><span class="s2">());</span>
            <span class="s1">model</span><span class="s2">.</span><span class="s1">addAttribute</span><span class="s2">(</span><span class="s3">&quot;searchList&quot;</span><span class="s2">, </span><span class="s1">searchList</span><span class="s2">);</span>
        <span class="s2">} </span><span class="s0">else </span><span class="s2">{</span><span class="s4">//searchStr가 비어있다면 그냥 페이징 처리된거 보여줘야징</span>
            <span class="s1">boardPage </span><span class="s2">= </span><span class="s1">boardService</span><span class="s2">.</span><span class="s1">pageList</span><span class="s2">(</span><span class="s1">pageable</span><span class="s2">);</span>
        <span class="s2">}</span>

        <span class="s0">int </span><span class="s1">startPage </span><span class="s2">= </span><span class="s1">Math</span><span class="s2">.</span><span class="s1">max</span><span class="s2">(</span><span class="s5">1</span><span class="s2">, </span><span class="s1">boardPage</span><span class="s2">.</span><span class="s1">getPageable</span><span class="s2">().</span><span class="s1">getPageNumber</span><span class="s2">() - </span><span class="s5">10</span><span class="s2">); </span><span class="s4">//10개의 게시글 보여줘야지</span>
        <span class="s0">int </span><span class="s1">endPage </span><span class="s2">= </span><span class="s1">Math</span><span class="s2">.</span><span class="s1">min</span><span class="s2">(</span><span class="s1">boardPage</span><span class="s2">.</span><span class="s1">getTotalPages</span><span class="s2">(), </span><span class="s1">boardPage</span><span class="s2">.</span><span class="s1">getPageable</span><span class="s2">().</span><span class="s1">getPageNumber</span><span class="s2">() + </span><span class="s5">10</span><span class="s2">);</span>
        <span class="s1">model</span><span class="s2">.</span><span class="s1">addAttribute</span><span class="s2">(</span><span class="s3">&quot;startPage&quot;</span><span class="s2">, </span><span class="s1">startPage</span><span class="s2">);</span>
        <span class="s1">model</span><span class="s2">.</span><span class="s1">addAttribute</span><span class="s2">(</span><span class="s3">&quot;endPage&quot;</span><span class="s2">, </span><span class="s1">endPage</span><span class="s2">);</span>
        <span class="s1">model</span><span class="s2">.</span><span class="s1">addAttribute</span><span class="s2">(</span><span class="s3">&quot;hasNext&quot;</span><span class="s2">, </span><span class="s1">boardPage</span><span class="s2">.</span><span class="s1">hasNext</span><span class="s2">()); </span><span class="s4">//다음페이지</span>
        <span class="s1">model</span><span class="s2">.</span><span class="s1">addAttribute</span><span class="s2">(</span><span class="s3">&quot;hasPrev&quot;</span><span class="s2">, </span><span class="s1">boardPage</span><span class="s2">.</span><span class="s1">hasPrevious</span><span class="s2">()); </span><span class="s4">//이전페이지</span>
        <span class="s1">model</span><span class="s2">.</span><span class="s1">addAttribute</span><span class="s2">(</span><span class="s3">&quot;nboard&quot;</span><span class="s2">, </span><span class="s1">boardPage</span><span class="s2">);</span>
        <span class="s0">return </span><span class="s3">&quot;list&quot;</span><span class="s2">; </span><span class="s4">// 검색 + 페이징 처리 통합</span>
    <span class="s2">}</span>


    <span class="s1">@GetMapping</span><span class="s2">(</span><span class="s1">value </span><span class="s2">= </span><span class="s3">&quot;/read/{no}&quot;</span><span class="s2">)</span>
    <span class="s0">public </span><span class="s1">String read</span><span class="s2">(</span><span class="s1">@PathVariable</span><span class="s2">(</span><span class="s3">&quot;no&quot;</span><span class="s2">) </span><span class="s1">Long no</span><span class="s2">, </span><span class="s1">Model model</span><span class="s2">, </span><span class="s1">@ModelAttribute Comment comment</span><span class="s2">, </span><span class="s1">HttpServletRequest request</span><span class="s2">, </span><span class="s1">Heart heart</span><span class="s2">) {</span>
        <span class="s1">List</span><span class="s2">&lt;</span><span class="s1">CommentRequestDto</span><span class="s2">&gt; </span><span class="s1">commentList </span><span class="s2">= </span><span class="s1">commentService</span><span class="s2">.</span><span class="s1">getComments</span><span class="s2">(</span><span class="s1">no</span><span class="s2">);</span>
        <span class="s1">HttpSession session </span><span class="s2">= </span><span class="s1">request</span><span class="s2">.</span><span class="s1">getSession</span><span class="s2">();</span>
        <span class="s1">String userId </span><span class="s2">= (</span><span class="s1">String</span><span class="s2">)</span><span class="s1">session</span><span class="s2">.</span><span class="s1">getAttribute</span><span class="s2">(</span><span class="s3">&quot;id&quot;</span><span class="s2">);</span>
        <span class="s1">boardService</span><span class="s2">.</span><span class="s1">hit</span><span class="s2">(</span><span class="s1">no</span><span class="s2">);</span>

        <span class="s1">model</span><span class="s2">.</span><span class="s1">addAttribute</span><span class="s2">(</span><span class="s3">&quot;like&quot;</span><span class="s2">,</span><span class="s1">heartService</span><span class="s2">.</span><span class="s1">findLike</span><span class="s2">(</span><span class="s1">no</span><span class="s2">,</span><span class="s1">userId</span><span class="s2">)); </span><span class="s4">//게시글 읽을때 좋아요 눌렀는지 확인?</span>
        <span class="s1">model</span><span class="s2">.</span><span class="s1">addAttribute</span><span class="s2">(</span><span class="s3">&quot;board&quot;</span><span class="s2">, </span><span class="s1">boardService</span><span class="s2">.</span><span class="s1">getPost</span><span class="s2">(</span><span class="s1">no</span><span class="s2">));</span>
        <span class="s1">model</span><span class="s2">.</span><span class="s1">addAttribute</span><span class="s2">(</span><span class="s3">&quot;comment&quot;</span><span class="s2">,</span><span class="s1">commentList</span><span class="s2">); </span><span class="s4">//댓글을 보여주기</span>
        <span class="s1">model</span><span class="s2">.</span><span class="s1">addAttribute</span><span class="s2">(</span><span class="s3">&quot;comments&quot;</span><span class="s2">,</span><span class="s1">comment</span><span class="s2">);</span>
        <span class="s1">model</span><span class="s2">.</span><span class="s1">addAttribute</span><span class="s2">(</span><span class="s3">&quot;heart&quot;</span><span class="s2">,</span><span class="s1">heart</span><span class="s2">);</span>
        <span class="s1">model</span><span class="s2">.</span><span class="s1">addAttribute</span><span class="s2">(</span><span class="s3">&quot;board_no&quot;</span><span class="s2">,</span><span class="s1">no</span><span class="s2">);</span>
        <span class="s0">return </span><span class="s3">&quot;detailboard&quot;</span><span class="s2">;</span>
    <span class="s2">}</span>

    <span class="s1">@GetMapping</span><span class="s2">(</span><span class="s3">&quot;/updateUser&quot;</span><span class="s2">)</span>
    <span class="s0">public </span><span class="s1">String updateUser</span><span class="s2">(</span><span class="s1">Model model</span><span class="s2">, </span><span class="s1">HttpServletRequest request</span><span class="s2">){</span>
        <span class="s1">HttpSession session  </span><span class="s2">= </span><span class="s1">request</span><span class="s2">.</span><span class="s1">getSession</span><span class="s2">();</span>
        <span class="s1">String id </span><span class="s2">= (</span><span class="s1">String</span><span class="s2">)</span><span class="s1">session</span><span class="s2">.</span><span class="s1">getAttribute</span><span class="s2">(</span><span class="s3">&quot;id&quot;</span><span class="s2">);</span>
        <span class="s1">String name </span><span class="s2">= (</span><span class="s1">String</span><span class="s2">)</span><span class="s1">session</span><span class="s2">.</span><span class="s1">getAttribute</span><span class="s2">(</span><span class="s3">&quot;name&quot;</span><span class="s2">);</span>
        <span class="s1">User user </span><span class="s2">= </span><span class="s0">null</span><span class="s2">;</span>
        <span class="s0">if </span><span class="s2">(</span><span class="s1">id </span><span class="s2">!= </span><span class="s0">null</span><span class="s2">) {</span>
            <span class="s1">user </span><span class="s2">= </span><span class="s1">userService</span><span class="s2">.</span><span class="s1">getUser</span><span class="s2">(</span><span class="s1">id</span><span class="s2">);</span>
        <span class="s2">} </span><span class="s0">else if </span><span class="s2">(</span><span class="s1">name </span><span class="s2">!= </span><span class="s0">null</span><span class="s2">) {</span>
            <span class="s1">user </span><span class="s2">= </span><span class="s1">userService</span><span class="s2">.</span><span class="s1">getUserName</span><span class="s2">(</span><span class="s1">name</span><span class="s2">);</span>

        <span class="s2">}</span>
        <span class="s1">model</span><span class="s2">.</span><span class="s1">addAttribute</span><span class="s2">(</span><span class="s3">&quot;user&quot;</span><span class="s2">,</span><span class="s1">user</span><span class="s2">);</span>
        <span class="s0">return </span><span class="s3">&quot;updateUser&quot;</span><span class="s2">;</span>
    <span class="s2">}</span>
    <span class="s1">@PostMapping</span><span class="s2">(</span><span class="s3">&quot;/saveUser&quot;</span><span class="s2">)</span>
    <span class="s0">public </span><span class="s1">String saveUser</span><span class="s2">( </span><span class="s1">HttpServletRequest request</span><span class="s2">, </span><span class="s1">Model model</span><span class="s2">, </span><span class="s1">@ModelAttribute UserUpdate updateDTO</span><span class="s2">){</span>
        <span class="s4">//Long no = userService.saveUser(user);</span>
        <span class="s1">HttpSession session </span><span class="s2">= </span><span class="s1">request</span><span class="s2">.</span><span class="s1">getSession</span><span class="s2">();</span>
        <span class="s1">String id </span><span class="s2">= (</span><span class="s1">String</span><span class="s2">)</span><span class="s1">session</span><span class="s2">.</span><span class="s1">getAttribute</span><span class="s2">(</span><span class="s3">&quot;id&quot;</span><span class="s2">);</span>
        <span class="s1">String name </span><span class="s2">= (</span><span class="s1">String</span><span class="s2">)</span><span class="s1">session</span><span class="s2">.</span><span class="s1">getAttribute</span><span class="s2">(</span><span class="s3">&quot;name&quot;</span><span class="s2">);</span>

        <span class="s0">if </span><span class="s2">(</span><span class="s1">id </span><span class="s2">!= </span><span class="s0">null</span><span class="s2">) {</span>
            <span class="s1">userService</span><span class="s2">.</span><span class="s1">updateUser</span><span class="s2">(</span><span class="s1">id</span><span class="s2">, </span><span class="s1">updateDTO</span><span class="s2">);</span>
            <span class="s1">User updatedUser </span><span class="s2">= </span><span class="s1">userService</span><span class="s2">.</span><span class="s1">getUser</span><span class="s2">(</span><span class="s1">id</span><span class="s2">);</span>
            <span class="s1">model</span><span class="s2">.</span><span class="s1">addAttribute</span><span class="s2">(</span><span class="s3">&quot;user&quot;</span><span class="s2">, </span><span class="s1">updatedUser</span><span class="s2">);</span>
        <span class="s2">} </span><span class="s0">else if </span><span class="s2">(</span><span class="s1">name </span><span class="s2">!= </span><span class="s0">null</span><span class="s2">) {</span>
            <span class="s1">userService</span><span class="s2">.</span><span class="s1">updatesocialUser</span><span class="s2">(</span><span class="s1">name</span><span class="s2">, </span><span class="s1">updateDTO</span><span class="s2">);</span>
            <span class="s1">User updatesocialUser </span><span class="s2">= </span><span class="s1">userService</span><span class="s2">.</span><span class="s1">getUserName</span><span class="s2">(</span><span class="s1">name</span><span class="s2">);</span>
            <span class="s1">model</span><span class="s2">.</span><span class="s1">addAttribute</span><span class="s2">(</span><span class="s3">&quot;user&quot;</span><span class="s2">, </span><span class="s1">updatesocialUser</span><span class="s2">);</span>
        <span class="s2">}</span>

        <span class="s4">//userService.updateUser(id, updateDTO); //정보 업데이트</span>
       <span class="s4">// userService.updateUser(name,updateDTO);</span>
        <span class="s4">//User updatedUser = userService.getUser(id);</span>

        <span class="s1">model</span><span class="s2">.</span><span class="s1">addAttribute</span><span class="s2">(</span><span class="s3">&quot;msg&quot;</span><span class="s2">, </span><span class="s3">&quot;정보 수정에 성공하였습니다.&quot;</span><span class="s2">);</span>
        <span class="s1">model</span><span class="s2">.</span><span class="s1">addAttribute</span><span class="s2">(</span><span class="s3">&quot;url&quot;</span><span class="s2">, </span><span class="s3">&quot;mypage&quot;</span><span class="s2">);</span>

        <span class="s0">return </span><span class="s3">&quot;myPage&quot;</span><span class="s2">;</span>
    <span class="s2">}</span>

    <span class="s1">@GetMapping</span><span class="s2">(</span><span class="s3">&quot;/deleteUser&quot;</span><span class="s2">)</span>
    <span class="s0">public </span><span class="s1">String deleteUser</span><span class="s2">( </span><span class="s1">Model model</span><span class="s2">,</span><span class="s1">HttpServletRequest request</span><span class="s2">){</span>
        <span class="s1">HttpSession session </span><span class="s2">= </span><span class="s1">request</span><span class="s2">.</span><span class="s1">getSession</span><span class="s2">();</span>
        <span class="s1">String id </span><span class="s2">= (</span><span class="s1">String</span><span class="s2">) </span><span class="s1">session</span><span class="s2">.</span><span class="s1">getAttribute</span><span class="s2">(</span><span class="s3">&quot;id&quot;</span><span class="s2">);</span>
        <span class="s1">String name </span><span class="s2">= (</span><span class="s1">String</span><span class="s2">)</span><span class="s1">session</span><span class="s2">.</span><span class="s1">getAttribute</span><span class="s2">(</span><span class="s3">&quot;name&quot;</span><span class="s2">);</span>
        <span class="s4">//String writerName = (String) session.getAttribute(&quot;id&quot;);//id 값이 writername 같기 떄문에ㅣ.!</span>
        <span class="s0">if </span><span class="s2">(</span><span class="s1">id </span><span class="s2">!= </span><span class="s0">null</span><span class="s2">) {</span>
            <span class="s1">userService</span><span class="s2">.</span><span class="s1">deleteUser</span><span class="s2">(</span><span class="s1">id</span><span class="s2">);</span>
        <span class="s2">} </span><span class="s0">else if </span><span class="s2">(</span><span class="s1">name </span><span class="s2">!= </span><span class="s0">null</span><span class="s2">) {</span>
            <span class="s1">userService</span><span class="s2">.</span><span class="s1">deleteSocialUser</span><span class="s2">(</span><span class="s1">name</span><span class="s2">);</span>
        <span class="s2">}</span>
        <span class="s4">//userService.deleteUser(id);</span>
        <span class="s1">session</span><span class="s2">.</span><span class="s1">invalidate</span><span class="s2">();</span>
        <span class="s0">return </span><span class="s3">&quot;redirect:/&quot;</span><span class="s2">;</span>
    <span class="s2">}</span>

    <span class="s1">@GetMapping</span><span class="s2">(</span><span class="s1">path</span><span class="s2">=</span><span class="s3">&quot;/myPage&quot;</span><span class="s2">)</span>
    <span class="s0">public </span><span class="s1">String myPage</span><span class="s2">(</span><span class="s1">Model model</span><span class="s2">,</span><span class="s1">HttpServletRequest request</span><span class="s2">){</span>
        <span class="s1">HttpSession session </span><span class="s2">= </span><span class="s1">request</span><span class="s2">.</span><span class="s1">getSession</span><span class="s2">();</span>
        <span class="s1">String id </span><span class="s2">= (</span><span class="s1">String</span><span class="s2">)</span><span class="s1">session</span><span class="s2">.</span><span class="s1">getAttribute</span><span class="s2">(</span><span class="s3">&quot;id&quot;</span><span class="s2">);</span>
        <span class="s1">String name </span><span class="s2">= (</span><span class="s1">String</span><span class="s2">)</span><span class="s1">session</span><span class="s2">.</span><span class="s1">getAttribute</span><span class="s2">(</span><span class="s3">&quot;name&quot;</span><span class="s2">);</span>
        <span class="s1">User user </span><span class="s2">= </span><span class="s1">userService</span><span class="s2">.</span><span class="s1">getUser</span><span class="s2">(</span><span class="s1">id</span><span class="s2">);</span>
        <span class="s1">User socialuser </span><span class="s2">= </span><span class="s1">userService</span><span class="s2">.</span><span class="s1">getUserName</span><span class="s2">(</span><span class="s1">name</span><span class="s2">);</span>

        <span class="s0">if </span><span class="s2">(</span><span class="s1">user </span><span class="s2">== </span><span class="s0">null </span><span class="s2">&amp;&amp; </span><span class="s1">socialuser</span><span class="s2">==</span><span class="s0">null</span><span class="s2">) {</span>
            <span class="s1">model</span><span class="s2">.</span><span class="s1">addAttribute</span><span class="s2">(</span><span class="s3">&quot;msg&quot;</span><span class="s2">, </span><span class="s3">&quot;로그인 후 이용가능&quot;</span><span class="s2">);</span>
        <span class="s2">} </span><span class="s0">else </span><span class="s2">{</span>
            <span class="s0">if </span><span class="s2">(</span><span class="s1">id </span><span class="s2">!= </span><span class="s0">null</span><span class="s2">) {</span>
                <span class="s1">model</span><span class="s2">.</span><span class="s1">addAttribute</span><span class="s2">(</span><span class="s3">&quot;user&quot;</span><span class="s2">, </span><span class="s1">user</span><span class="s2">);</span>
            <span class="s2">} </span><span class="s0">else </span><span class="s2">{</span>
                <span class="s1">model</span><span class="s2">.</span><span class="s1">addAttribute</span><span class="s2">(</span><span class="s3">&quot;user&quot;</span><span class="s2">, </span><span class="s1">socialuser</span><span class="s2">);</span>
            <span class="s2">}</span>
        <span class="s2">}</span>
        <span class="s0">return </span><span class="s3">&quot;myPage&quot;</span><span class="s2">;</span>
    <span class="s2">}</span>
    <span class="s1">@GetMapping</span><span class="s2">(</span><span class="s3">&quot;/myBoardList&quot;</span><span class="s2">)</span>
    <span class="s0">public </span><span class="s1">String myBoard</span><span class="s2">(</span><span class="s1">HttpServletRequest request</span><span class="s2">, </span><span class="s1">Model model</span><span class="s2">){</span>
        <span class="s1">HttpSession session </span><span class="s2">= </span><span class="s1">request</span><span class="s2">.</span><span class="s1">getSession</span><span class="s2">();</span>
        <span class="s1">String id </span><span class="s2">= (</span><span class="s1">String</span><span class="s2">) </span><span class="s1">session</span><span class="s2">.</span><span class="s1">getAttribute</span><span class="s2">(</span><span class="s3">&quot;id&quot;</span><span class="s2">);</span>
        <span class="s1">String name </span><span class="s2">= (</span><span class="s1">String</span><span class="s2">) </span><span class="s1">session</span><span class="s2">.</span><span class="s1">getAttribute</span><span class="s2">(</span><span class="s3">&quot;name&quot;</span><span class="s2">);</span>
        <span class="s1">List</span><span class="s2">&lt;</span><span class="s1">Board</span><span class="s2">&gt; </span><span class="s1">myBoards </span><span class="s2">= </span><span class="s0">new </span><span class="s1">ArrayList</span><span class="s2">&lt;&gt;();</span>
        <span class="s1">User user </span><span class="s2">= </span><span class="s0">null</span><span class="s2">;</span>
        <span class="s1">List</span><span class="s2">&lt;</span><span class="s1">CommentWithBoardTitle</span><span class="s2">&gt; </span><span class="s1">commentsWithBoardTitle </span><span class="s2">= </span><span class="s0">null</span><span class="s2">;</span>
        <span class="s0">if </span><span class="s2">(</span><span class="s1">id </span><span class="s2">!= </span><span class="s0">null</span><span class="s2">) {</span>
            <span class="s1">user </span><span class="s2">= </span><span class="s1">userService</span><span class="s2">.</span><span class="s1">getUser</span><span class="s2">(</span><span class="s1">id</span><span class="s2">);</span>
            <span class="s1">myBoards </span><span class="s2">= </span><span class="s1">boardService</span><span class="s2">.</span><span class="s1">myboard</span><span class="s2">(</span><span class="s1">id</span><span class="s2">);</span>
            <span class="s1">commentsWithBoardTitle </span><span class="s2">= </span><span class="s1">commentService</span><span class="s2">.</span><span class="s1">CommentsWithBoardTitle</span><span class="s2">(</span><span class="s1">id</span><span class="s2">);</span>
        <span class="s2">} </span><span class="s0">else if </span><span class="s2">(</span><span class="s1">name </span><span class="s2">!= </span><span class="s0">null</span><span class="s2">) {</span>
            <span class="s1">user </span><span class="s2">= </span><span class="s1">userService</span><span class="s2">.</span><span class="s1">getUserName</span><span class="s2">(</span><span class="s1">name</span><span class="s2">);</span>
            <span class="s1">myBoards </span><span class="s2">= </span><span class="s1">boardService</span><span class="s2">.</span><span class="s1">myboard</span><span class="s2">(</span><span class="s1">name</span><span class="s2">);</span>
            <span class="s1">commentsWithBoardTitle </span><span class="s2">= </span><span class="s1">commentService</span><span class="s2">.</span><span class="s1">CommentsWithBoardTitle</span><span class="s2">(</span><span class="s1">name</span><span class="s2">);</span>
        <span class="s2">}</span>

        <span class="s1">model</span><span class="s2">.</span><span class="s1">addAttribute</span><span class="s2">(</span><span class="s3">&quot;myBoard&quot;</span><span class="s2">, </span><span class="s1">user</span><span class="s2">);</span>
        <span class="s1">model</span><span class="s2">.</span><span class="s1">addAttribute</span><span class="s2">(</span><span class="s3">&quot;myBoards&quot;</span><span class="s2">, </span><span class="s1">myBoards</span><span class="s2">);</span>
        <span class="s1">model</span><span class="s2">.</span><span class="s1">addAttribute</span><span class="s2">(</span><span class="s3">&quot;Comments&quot;</span><span class="s2">, </span><span class="s1">commentsWithBoardTitle</span><span class="s2">);</span>

        <span class="s0">return </span><span class="s3">&quot;myBoardList&quot;</span><span class="s2">;</span>
    <span class="s2">}</span>

<span class="s2">}</span>







</pre>
</body>
</html>